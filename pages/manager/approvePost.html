<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Posts</title>
    <link rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css" />
    <link rel="stylesheet" href="../../style/manager/approvePost.css" />
    <script src="script.js" defer></script>
</head>

<body>
    <section>
        <header>
            <div>
                <img class="afteracadstext" src="../../assets/logo.png" alt="AfterAcads" />
            </div>
            <ul class="nav-links">
                <li><a href="../../pages/manager/home.html">Home</a></li>
                <li><a href="../../pages/manager/Registrants.html">Registrants</a></li>
                <li><a href="../../pages/manager/approvePost.html">Posts</a></li>
                <li><a href="../../pages/manager/eventsDashboard.html">Events</a></li>
                <li><a href="../../pages/manager/opportunities.html">Opportunities</a></li>
                <li><a href="../../pages/manager/notifications.html">Notifications</a></li>
                <li><a href="../../pages/manager/statistics.php">Statistics</a></li>
            </ul>
            <div class="profile">
                <li><a href="viewProfile.php"><img class="profile-img" src="../../assets/profileIcon.jpg"
                            alt="Profile" /></a></li>
            </div>
        </header>
    </section>
    <div class="posts-section container">
        <div class="button-group">
            <button class="btn pending">Pending Posts</button>
            <button class="btn approved">Approved Posts</button>
            <button class="btn denied">Denied Posts</button>
        </div>

        <!-- Table for Pending Posts -->
        <table class="post-table pending-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Joe29</span>
                        </div>
                    </td>
                    <td>Joe</td>
                    <td>Hello</td>
                    <td>11/29/2024</td>
                    <td class="action-buttons">
                        <button class="btn approve">Approve</button>
                        <button class="btn deny">Deny</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Joe29</span>
                        </div>
                    </td>
                    <td>Michael</td>
                    <td>Hi</td>
                    <td>11/30/2024</td>
                    <td class="action-buttons">
                        <button class="btn approve">Approve</button>
                        <button class="btn deny">Deny</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Table for Approved Posts -->
        <table class="post-table approved-table" style="display: none;">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Joe29</span>
                        </div>
                    </td>                    
                    <td>Joe</td>
                    <td>Hello</td>
                    <td>11/29/2024</td>
                    <td class="action-buttons">
                        <button class="btn deny">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Table for Denied Posts -->
        <table class="post-table denied-table" style="display: none;">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <tbody>
                    <tr>
                        <td>
                            <div class="user-info">
                                <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                                <span class="username">Joe29</span>
                            </div>
                        </td>
                        <td>Joe</td>
                        <td>Hello</td>
                        <td>11/29/2024</td>
                    </tr>
                </tbody>
            </tbody>
        </table>
    </div>

    <div class="post-details-modal" id="postDetailsModal">
        <div class="modal-content">
            <div class="modal-content-pending">
                <span class="close-btn" id="closeModal">&times;</span>
            <h2>Post Details</h2>
            <hr class="modal-divider">
            <p><strong>Username:</strong> <span id="postName"></span></p>
            <p><strong>Content:</strong> <span id="postContent"></span></p>
            <p><strong>Image:</strong> <span id="postImage"></span></p>
            <p><strong>Tag:</strong> <span id="postTag"></span></p>
            <p><strong>Date:</strong> <span id="postDate"></span></p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
    const rows = document.querySelectorAll(".post-table tbody tr");
    const modal = document.getElementById("postDetailsModal");
    const closeModalButton = document.getElementById("closeModal");
    const statusButtons = document.querySelectorAll(".button-group .btn");
    const approvedTable = document.querySelector(".approved-table tbody");
    const deniedTable = document.querySelector(".denied-table tbody");
    const pendingTable = document.querySelector(".pending-table tbody");

    let postStatus = {};
    let approvedPosts = [];
    let deniedPosts = [];

    // Function to switch between tables
    const toggleTable = (status) => {
        const pendingTable = document.querySelector(".pending-table");
        const approvedTable = document.querySelector(".approved-table");
        const deniedTable = document.querySelector(".denied-table");

        if (status === "approved") {
            pendingTable.style.display = "none";
            approvedTable.style.display = "table";
            deniedTable.style.display = "none";
        } else if (status === "denied") {
            pendingTable.style.display = "none";
            approvedTable.style.display = "none";
            deniedTable.style.display = "table";
        } else {
            pendingTable.style.display = "table";
            approvedTable.style.display = "none";
            deniedTable.style.display = "none";
        }
    };

    // Handle row click to open modal
    rows.forEach(row => {
        row.addEventListener("click", function () {
            const name = this.cells[0].textContent.trim() || "N/A";
            const content = this.cells[2].textContent.trim() || "N/A";
            const date = this.cells[3].textContent.trim() || "N/A";
            const imageSrc = this.querySelector("img")?.src || "N/A";

            document.getElementById("postName").textContent = name;
            document.getElementById("postContent").textContent = content;
            document.getElementById("postDate").textContent = date;
            document.getElementById("postImage").textContent = "N/A";
            document.getElementById("postTag").textContent = "N/A"; 

            modal.style.display = "flex";
        });
    });

    closeModalButton.addEventListener("click", () => {
        modal.style.display = "none";
    });

    window.addEventListener("click", (event) => {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    });

    // Handle approve and deny buttons
    document.querySelectorAll(".btn.approve").forEach(button => {
        button.addEventListener("click", (event) => {
            event.stopPropagation();
            const row = button.closest("tr");
            postStatus[row.cells[0].textContent] = "approved";
            console.log(`${row.cells[0].textContent} approved`);

            // Move the post to approvedPosts table
            const approvedPost = {
                name: row.cells[1].textContent,
                description: row.cells[2].textContent
            };
            approvedPosts.push(approvedPost);
            updateApprovedPostsTable();
        });
    });

    document.querySelectorAll(".btn.deny").forEach(button => {
        button.addEventListener("click", (event) => {
            event.stopPropagation();
            const row = button.closest("tr");
            postStatus[row.cells[0].textContent] = "denied";
            console.log(`${row.cells[0].textContent} denied`);

            // Move the post to deniedPosts table
            const deniedPost = {
                name: row.cells[1].textContent,
                description: row.cells[2].textContent
            };
            deniedPosts.push(deniedPost);
            updateDeniedPostsTable();
        });
    });

    // Update the approved posts table
    const updateApprovedPostsTable = () => {
        approvedTable.innerHTML = ""; // Clear existing posts
        approvedPosts.forEach(post => {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td>${post.name || "N/A"}</td>
            <td>${post.description || "N/A"}</td>
            <td><button class="btn delete">Delete</button></td>
        `;
            approvedTable.appendChild(row);

            // Add delete functionality
            row.querySelector(".btn.delete").addEventListener("click", () => {
                row.remove();
                // Optionally, remove the post from the approvedPosts array as well
                approvedPosts = approvedPosts.filter(p => p !== post);
            });
        });
    };

    // Update the denied posts table
    const updateDeniedPostsTable = () => {
        deniedTable.innerHTML = ""; // Clear existing posts
        deniedPosts.forEach(post => {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td>${post.name || "N/A"}</td>
            <td>${post.description || "N/A"}</td>
        `;
            deniedTable.appendChild(row);
        });
    };

    // Handle filter buttons (Pending, Approved, Denied)
    statusButtons.forEach(button => {
        button.addEventListener("click", () => {
            const status = button.classList.contains("pending")
                ? "pending"
                : button.classList.contains("approved")
                    ? "approved"
                    : "denied";

            // Toggle between tables based on status
            toggleTable(status);
        });
    });
});

    </script>
</body>

</html>