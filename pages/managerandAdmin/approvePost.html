<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Posts</title>
    <link rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css" />
    <link rel="stylesheet" href="../../style/managerAndAdmin/approvePost.css" />
    <script src="script.js" defer></script>
</head>

<body>
    <section>
        <header>
            <div>
                <img class="afteracadstext" src="../../assets/logo.png" alt="AfterAcads" />
            </div>
            <ul class="nav-links">
                <li><a href="../../pages/managerAndAdmin/home.html">Home</a></li>
                <li><a href="../../pages/managerAndAdmin/Registrants.html">Registrants</a></li>
                <li><a href="../../pages/managerAndAdmin/approvePost.html">Posts</a></li>
                <li><a href="../../pages/managerAndAdmin/eventsDashboard.html">Events</a></li>
                <li><a href="../../pages/managerAndAdmin/opportunities.html">Opportunities</a></li>
                <li><a href="../../pages/managerAndAdmin/statistics.php">Statistics</a></li>
                <li><a href="../../pages/managerAndAdmin/user.html">Users</a></li>
            </ul>
            <div class="profile">
                <li><a href="../../pages/managerAndAdmin/managerProfile.html"><img class="profile-img"
                            src="../../assets/profileIcon.jpg" alt="Profile" /></a></li>
            </div>
        </header>
    </section>
    <div class="posts-section container">
        <div class="search-and-buttons">
            <input type="text" class="search-input" placeholder="Search..." />
            <div class="button-group">
                <button class="btn pending">Pending Posts</button>
                <button class="btn approved">Approved Posts</button>
                <button class="btn denied">Denied Posts</button>
            </div>
        </div>

        <!-- Table for Pending Posts -->
        <table class="post-table pending-table">
            <thead>
                <tr>
                    <th>Username
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Chloe31</span>
                        </div>
                    </td>
                    <td>Chloe San Miguel</td>
                    <td>Hello</td>
                    <td>11/29/2024</td>
                    <td class="action-buttons">
                        <button class="btn approve">Approve</button>
                        <button class="btn deny">Deny</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Jelai29</span>
                        </div>
                    </td>
                    <td>Jerilyn Cahanap</td>
                    <td>Hi</td>
                    <td>11/30/2024</td>
                    <td class="action-buttons">
                        <button class="btn approve">Approve</button>
                        <button class="btn deny">Deny</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Table for Approved Posts -->
        <table class="post-table approved-table" style="display: none;">
            <thead>
                <tr>
                    <th>Username
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Juju</span>
                        </div>
                    </td>
                    <td>Julianne Abitan</td>
                    <td>Hi guys</td>
                    <td>11/29/2024</td>
                    <td class="action-buttons">
                        <button class="btn deny">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Table for Denied Posts -->
        <table class="post-table denied-table" style="display: none;">
            <thead>
                <tr>
                    <th>Username
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                    <th>Name</th>
                    <th>Content</th>
                    <th>Date
                        <button class="sort-button" data-sort="asc" onclick="toggleSort(this, 2)">
                            <span class="arrow-up">&#9650;</span>
                            <span class="arrow-down">&#9660;</span>
                        </button>
                    </th>
                </tr>
            </thead>
            <tbody>
            <tbody>
                <tr>
                    <td>
                        <div class="user-info">
                            <img class="user-avatar" src="../../assets/profileIcon.jpg" alt="user avatar" />
                            <span class="username">Joe29</span>
                        </div>
                    </td>
                    <td>Joe</td>
                    <td>Hello</td>
                    <td>11/29/2024</td>
                </tr>
            </tbody>
            </tbody>
        </table>
    </div>

    <div class="post-details-modal" id="postDetailsModal">
        <div class="modal-content">
            <div class="modal-content-pending">
                <span class="close-btn" id="closeModal">&times;</span>
                <h2>Post Details</h2>
                <hr class="modal-divider">
                <p><strong>Username:</strong> <span id="postName"></span></p>
                <p><strong>Content:</strong> <span id="postContent"></span></p>
                <p><strong>Image:</strong> <span id="postImage"></span></p>
                <p><strong>Tag:</strong> <span id="postTag"></span></p>
                <p><strong>Date:</strong> <span id="postDate"></span></p>
            </div>
        </div>
    </div>

    <!-- Script for the Tables -->
    <script>

        document.addEventListener("DOMContentLoaded", () => {
            const rows = document.querySelectorAll(".post-table tbody tr");
            const modal = document.getElementById("postDetailsModal");
            const closeModalButton = document.getElementById("closeModal");
            const statusButtons = document.querySelectorAll(".button-group .btn");
            const actionButtons = document.querySelectorAll(".action-buttons button");

            // Function to switch between tables
            const toggleTable = (status) => {
                const pendingTable = document.querySelector(".pending-table");
                const approvedTable = document.querySelector(".approved-table");
                const deniedTable = document.querySelector(".denied-table");

                if (status === "approved") {
                    pendingTable.style.display = "none";
                    approvedTable.style.display = "table";
                    deniedTable.style.display = "none";
                } else if (status === "denied") {
                    pendingTable.style.display = "none";
                    approvedTable.style.display = "none";
                    deniedTable.style.display = "table";
                } else {
                    pendingTable.style.display = "table";
                    approvedTable.style.display = "none";
                    deniedTable.style.display = "none";
                }
            };

            // Prevent modal from opening when clicking on action buttons
            actionButtons.forEach(button => {
                button.addEventListener("click", (event) => {
                    event.stopPropagation();
                });
            });

            // Handle row click to open modal and populate post details
            rows.forEach(row => {
                row.addEventListener("click", function () {
                    const name = this.cells[0].textContent.trim() || "N/A";
                    const content = this.cells[2].textContent.trim() || "N/A";
                    const date = this.cells[3].textContent.trim() || "N/A";
                    const imageSrc = this.querySelector("img")?.src || "N/A";

                    document.getElementById("postName").textContent = name;
                    document.getElementById("postContent").textContent = content;
                    document.getElementById("postDate").textContent = date;
                    document.getElementById("postImage").textContent = "N/A";
                    document.getElementById("postTag").textContent = "N/A";

                    modal.style.display = "flex";
                });
            });

            // Close modal functionality
            closeModalButton.addEventListener("click", () => {
                modal.style.display = "none";
            });

            window.addEventListener("click", (event) => {
                if (event.target === modal) {
                    modal.style.display = "none";
                }
            });

            // Handle filter buttons (Pending, Approved, Denied)
            statusButtons.forEach(button => {
                button.addEventListener("click", () => {
                    const status = button.classList.contains("pending")
                        ? "pending"
                        : button.classList.contains("approved")
                            ? "approved"
                            : "denied";

                    // Toggle between tables based on status
                    toggleTable(status);
                });
            });
        });
    </script>

    <!-- Script for Sorting -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const tables = document.querySelectorAll(".post-table");

            function sortTable(table, columnIndex, isAscending) {
                const tbody = table.querySelector("tbody");
                const rows = Array.from(tbody.rows);

                rows.sort((a, b) => {
                    const cellA = a.cells[columnIndex].textContent.trim();
                    const cellB = b.cells[columnIndex].textContent.trim();

                    if (!isNaN(Date.parse(cellA)) && !isNaN(Date.parse(cellB))) {
                        return isAscending ? new Date(cellA) - new Date(cellB) : new Date(cellB) - new Date(cellA);
                    }

                    if (!isNaN(cellA) && !isNaN(cellB)) {
                        return isAscending ? cellA - cellB : cellB - cellA;
                    }

                    return isAscending ? cellA.localeCompare(cellB) : cellB.localeCompare(cellA);
                });

                rows.forEach(row => tbody.appendChild(row));
            }

            function toggleSort(button, table, columnIndex) {
                const isAscending = button.dataset.sort === "asc";
                button.dataset.sort = isAscending ? "desc" : "asc";
                sortTable(table, columnIndex, !isAscending);
            }

            tables.forEach(table => {
                const sortButtons = table.querySelectorAll(".sort-button");

                sortButtons.forEach((button, index) => {
                    button.addEventListener("click", () => toggleSort(button, table, index));
                });
            });
        });

    </script>

    <!-- Script for Search Input -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const searchInput = document.querySelector(".search-input");
            const tables = document.querySelectorAll(".post-table");

            const filterRows = (searchValue) => {
                tables.forEach((table) => {
                    const rows = table.querySelectorAll("tbody tr");
                    rows.forEach((row) => {
                        const cells = row.querySelectorAll("td");
                        const rowText = Array.from(cells)
                            .map((cell) => cell.textContent.toLowerCase())
                            .join(" ");
                        if (rowText.includes(searchValue.toLowerCase())) {
                            row.style.display = "";
                        } else {
                            row.style.display = "none";
                        }
                    });
                });
            };

            searchInput.addEventListener("input", (event) => {
                const searchValue = event.target.value.trim();
                filterRows(searchValue);
            });
        });
    </script>
</body>

</html>